# collapsed-5services-with-meta-no-update.stoverride
name: ip-pure-collapsed-5services
desc: "IPPure 多平台解锁检测（5 服务）——为 Stash 第三方服务/Availability 面板定制"
author: "由 ChatGPT 为代码小白生成（按原检测逻辑保留）"

tiles:
  - name: svc-netflix
    desc: "检测 Netflix 解锁状态"
    title: Netflix 解锁检测
    content: 等待检测...
    icon: play.tv.fill
    interval: 30
    collapsed: true

  - name: svc-disney
    desc: "检测 Disney+ 解锁状态"
    title: Disney+ 解锁检测
    content: 等待检测...
    icon: sparkles
    interval: 30
    collapsed: true

  - name: svc-chatgpt
    desc: "检测 ChatGPT 可用性与地区"
    title: ChatGPT 可用性检测
    content: 等待检测...
    icon: bubble.left.and.bubble.right.fill
    interval: 30
    collapsed: true

  - name: svc-youtube
    desc: "检测 YouTube Premium 可用性"
    title: YouTube Premium 检测
    content: 等待检测...
    icon: play.rectangle.fill
    interval: 30
    collapsed: true

  - name: svc-spotify
    desc: "检测 Spotify 可用性"
    title: Spotify 解锁检测
    content: 等待检测...
    icon: music.note.list
    interval: 30
    collapsed: true

script-providers:
  svc-netflix:
    content: |
      const REQUEST_HEADERS = { 'User-Agent': 'Mozilla/5.0', 'Accept-Language': 'en' };
      function httpGet(url, headers = {}, timeout = 6000) {
        return new Promise((resolve) => {
          $httpClient.get({ url, headers, timeout }, (err, resp, data) => {
            if (err) resolve(null); else resolve({ status: resp.status, data });
          });
        });
      }
      (async () => {
        try {
          const res = await httpGet('https://www.netflix.com/title/80018499', REQUEST_HEADERS);
          const ok = res && res.status === 200;
          $done({
            title: ok ? 'Netflix：已解锁' : 'Netflix：未解锁或检测失败',
            content: ok ? 'Netflix 可访问 — 建议在播放器中测试播放' : '当前节点无法访问 Netflix 或请求被拦截',
            icon: 'play.tv.fill',
            backgroundColor: ok ? '#34C759' : '#FF3B30'
          });
        } catch (e) {
          $done({ title: 'Netflix：检测异常', content: String(e), icon: 'exclamationmark.triangle' });
        }
      })();

  svc-disney:
    content: |
      const REQUEST_HEADERS = { 'User-Agent': 'Mozilla/5.0', 'Accept-Language': 'en' };
      function httpGet(url, headers = {}, timeout = 6000) {
        return new Promise((resolve) => {
          $httpClient.get({ url, headers, timeout }, (err, resp, data) => {
            if (err) resolve(null); else resolve({ status: resp.status, data });
          });
        });
      }
      (async () => {
        try {
          const res = await httpGet('https://www.disneyplus.com/', REQUEST_HEADERS);
          const ok = res && res.status === 200;
          $done({
            title: ok ? 'Disney+：已解锁' : 'Disney+：未解锁或检测失败',
            content: ok ? 'Disney+ 页面可访问 — 建议播放确认' : '当前节点无法访问 Disney+ 或被限制',
            icon: 'sparkles',
            backgroundColor: ok ? '#34C759' : '#FF3B30'
          });
        } catch (e) {
          $done({ title: 'Disney+：检测异常', content: String(e), icon: 'exclamationmark.triangle' });
        }
      })();

  svc-chatgpt:
    content: |
      const REQUEST_HEADERS = { 'User-Agent': 'Mozilla/5.0', 'Accept-Language': 'en' };
      function httpGet(url, headers = {}, timeout = 6000) {
        return new Promise((resolve) => {
          $httpClient.get({ url, headers, timeout }, (err, resp, data) => {
            if (err) resolve(null); else resolve({ status: resp.status, data });
          });
        });
      }
      (async () => {
        try {
          const res = await httpGet('https://chat.openai.com/cdn-cgi/trace', REQUEST_HEADERS);
          let ok = false;
          let region = '';
          if (res && res.status === 200 && res.data) {
            ok = true;
            const m = String(res.data).match(/loc=([A-Z]{2})/);
            if (m) region = m[1];
          }
          $done({
            title: ok ? `ChatGPT：可用 ${region ? '(' + region + ')' : ''}` : 'ChatGPT：不可用或检测失败',
            content: ok ? `ChatGPT 可访问 — 区域: ${region || '未知'}` : '当前节点无法访问 ChatGPT 或请求被阻断',
            icon: 'bubble.left.and.bubble.right.fill',
            backgroundColor: ok ? '#34C759' : '#FF3B30'
          });
        } catch (e) {
          $done({ title: 'ChatGPT：检测异常', content: String(e), icon: 'exclamationmark.triangle' });
        }
      })();

  svc-youtube:
    content: |
      const REQUEST_HEADERS = { 'User-Agent': 'Mozilla/5.0', 'Accept-Language': 'en' };
      function httpGet(url, headers = {}, timeout = 6000) {
        return new Promise((resolve) => {
          $httpClient.get({ url, headers, timeout }, (err, resp, data) => {
            if (err) resolve(null); else resolve({ status: resp.status, data });
          });
        });
      }
      (async () => {
        try {
          const res = await httpGet('https://www.youtube.com/premium', REQUEST_HEADERS);
          const ok = res && res.status === 200;
          $done({
            title: ok ? 'YouTube Premium：已解锁' : 'YouTube Premium：未解锁或检测失败',
            content: ok ? 'YouTube Premium 页面可访问' : '当前节点无法访问 YouTube Premium 或被限制',
            icon: 'play.rectangle.fill',
            backgroundColor: ok ? '#34C759' : '#FF3B30'
          });
        } catch (e) {
          $done({ title: 'YouTube：检测异常', content: String(e), icon: 'exclamationmark.triangle' });
        }
      })();

  svc-spotify:
    content: |
      const REQUEST_HEADERS = { 'User-Agent': 'Mozilla/5.0', 'Accept-Language': 'en' };
      function httpGet(url, headers = {}, timeout = 6000) {
        return new Promise((resolve) => {
          $httpClient.get({ url, headers, timeout }, (err, resp, data) => {
            if (err) resolve(null); else resolve({ status: resp.status, data });
          });
        });
      }
      (async () => {
        try {
          const res = await httpGet('https://open.spotify.com/', REQUEST_HEADERS);
          const ok = res && res.status === 200;
          $done({
            title: ok ? 'Spotify：已解锁' : 'Spotify：未解锁或检测失败',
            content: ok ? 'Spotify 首页可访问' : '当前节点无法访问 Spotify 或被限制',
            icon: 'music.note.list',
            backgroundColor: ok ? '#34C759' : '#FF3B30'
          });
        } catch (e) {
          $done({ title: 'Spotify：检测异常', content: String(e), icon: 'exclamationmark.triangle' });
        }
      })();
